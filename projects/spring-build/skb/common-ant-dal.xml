<?xml version="1.0" encoding="UTF-8"?>
<project name="skb-ant-dal" xmlns:ivy="antlib:org.apache.ivy.ant">

	<target name="dal2sql.init" depends="ivy.init">
		<echo message="Removing autogenerated SQL files"/>
		<delete verbose="true">
			<fileset dir="${target.dir}" includes="**/sql/*.sql" />
		</delete>
		<echo message="Resolving Dal2SqlTask"/>
                <ivy:cachepath resolveId="skb.ant.dal.path" pathid="skb.ant.dal.path"
			organisation="skb" module="skb.ant.dal" revision="${skb.ant.dal}"
			conf="runtime" type="jar" inline="true" log="download-only" />
		<taskdef name="skb-dal2sql"
			classname="org.skb.ant.dal.Dal2SqlTask"
			classpathref="skb.ant.dal.path"/>
	</target>

	<target name="dal2sql" description="Generates SQL from DAL sources"/>

	<macrodef name="generate-dal2sql">
		<attribute name="dest.dir"/>
		<element name="dal-elems" implicit="yes"/>
		<sequential>
		  <mkdir dir="@{dest.dir}"/>
			<skb-dal2sql destdir="@{dest.dir}">
			  <dal-elems/>
			</skb-dal2sql>
		</sequential>
	</macrodef>

</project>
	
